<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wanderlust ‚Äì Blog</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      margin: 0;
      padding: 0;
      background: url('./images/bg.png') no-repeat center center fixed; 
      background-size: cover;
      color: #333;
    }
    .overlay {
      background: rgba(0,0,0,0.6); /* dark overlay so text is readable */
      min-height: 100vh;
    }
    .hero { color: #fff; padding: 3rem 2rem; text-align: center; }
    .container { max-width: 1000px; margin: auto; padding: 2rem; background: #fff; }
    h1, h2, h3 { color: #2d3748; }
    pre { background: #1a202c; color: #f8f8f2; padding: 1rem; border-radius: 8px; overflow-x: auto; }
    code { font-family: monospace; }
    .toc { background: #edf2f7; padding: 1rem; border-radius: 8px; margin-bottom: 2rem; }
    .screenshot { margin: 1.5rem 0; text-align: center; }
    .screenshot img { max-width: 100%; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.15); }
    .tags { margin-top: 2rem; }
    .tags span { display: inline-block; background: #e2e8f0; color: #2d3748; padding: 0.3rem 0.8rem; border-radius: 20px; margin: 0.3rem; font-size: 0.9rem; }
  </style>
</head>
<body>
  <div class="overlay">
    <!-- all your blog content here -->
    <section class="hero">
      <h1 style="color: white; font-size: 3rem;">DevOps Project ‚Äì WanderLust CI/CD Setup</h1>
      <p style="font-size: 1.3rem;">A three-tier application to post travel blogs with full CI/CD pipeline, GitOps, and monitoring.</p>
    </section>

    <div class="container">
      <!-- all your sections go here -->
      <section class="toc">
        <h2>üìë Table of Contents</h2>
        <ul>
          <li><a href="#intro">Introduction</a></li>
          <li><a href="#infra-setup">Infrastructure Setup</a></li>
          <li><a href="#jenkins">Jenkins Setup</a></li>
          <li><a href="#ci-pipeline">CI Pipeline</a></li>
          <li><a href="#cd-pipeline">CD Pipeline with ArgoCD</a></li>
          <li><a href="#monitoring">Monitoring with Prometheus & Grafana</a></li>
          <li><a href="#conclusion">Conclusion</a></li>
        </ul>
      </section>
  
      <section id="intro">
        <h2>üåç Introduction</h2>
        <p><strong>Wanderlust</strong> is my homelab DevOps project where I built and deployed a three‚Äëtier travel blog application. The goal was to practice end‚Äëto‚Äëend CI/CD pipelines, GitOps with ArgoCD, security scans, and monitoring.</p>
      </section>
  
      <section id="infra-setup">
        <h2>üõ† Infrastructure Setup</h2>
        <p>Since this was a homelab, I created a compact setup on my Mac and another laptop:</p>
        <ul>
          <li>üíª <strong>Mac (Jenkins Server):</strong> Installed Java and Jenkins</li>
          <li>üñ• <strong>VM on Mac:</strong> Installed Docker, Docker Compose, Java, kubectl, SonarQube, Trivy, and initiated a <code>k3s</code> cluster (master/control‚Äëplane)</li>
          <li>üíª <strong>Another Laptop:</strong> Added as a worker node to the <code>k3s</code> cluster</li>
          <li>Both VM and laptop were added as Jenkins agents (CI on VM, CD on worker)</li>
        </ul>
  
        <div class="screenshot">
          <p>My Cluster Setup</p>
          <img src="images/Workflow.png" alt="Cluster Setup">
        </div>
      </section>
  
      <section id="jenkins">
        <h2>üîß Jenkins Setup</h2>
        <p>On Jenkins, I configured credentials and plugins to integrate with external tools:</p>
        <ul>
          <li>üîë GitHub, DockerHub, SonarQube credentials</li>
          <li>üì© SMTP on port 465 for email notifications</li>
          <li>üîå Plugins: OWASP Dependency Check, SonarQube, NodeJS, Docker, Pipeline Stage View, Blue Ocean</li>
        </ul>
  
        <h3>SonarQube Integration</h3>
        <pre><code># Example: Adding SonarQube token as secret text in Jenkins
  Manage Jenkins ‚Üí Credentials ‚Üí Add Secret Text ‚Üí SONAR_TOKEN</code></pre>
  
        <h3>Shared Libraries</h3>
        <p>I created reusable <strong>Groovy shared libraries</strong> for Jenkins pipelines and linked them as a global trusted library in Jenkins. Repo: 
        <a href="https://github.com/Sann-777/Jenkins-shared-libraries" target="_blank">My Shared Library for Jenkins</a></p>
  
        <div class="screenshot">
          <p>Jenkins CI Pipeline</p>
          <img src="images/Jenkins_CI.png" alt="Jenkins Pipeline">
        </div>
        <div class="screenshot">
          <p>Jenkins CD Pipeline</p>
          <img src="images/Jenkins_CD.png" alt="Jenkins Pipeline">
        </div>
      </section>
  
      <section id="ci-pipeline">
        <h2>‚öôÔ∏è CI Pipeline</h2>
        <p>The CI pipeline ran on the VM (Jenkins agent) and included:</p>
        <ol>
          <li>Checkout from GitHub</li>
          <li>Build & test</li>
          <li>Static code analysis with SonarQube</li>
          <li>Security scan with Trivy & OWASP Dependency Check</li>
          <li>Docker image build & push to DockerHub</li>
        </ol>
        
        <h4>Here's the CI pipeline code</h2>
        <pre style="max-height:400px; overflow:auto;">
        <code>
          @Library('Shared') _
          pipeline {
              agent {label 'vinod'}
              
              environment{
                  SONAR_HOME = tool "Sonar"
              }
              
              parameters {
                  string(name: 'FRONTEND_DOCKER_TAG', defaultValue: '', description: 'Setting docker image for latest push')
                  string(name: 'BACKEND_DOCKER_TAG', defaultValue: '', description: 'Setting docker image for latest push')
              }
              
              stages {
                  stage("Validate Parameters") {
                      steps {
                          script {
                              if (params.FRONTEND_DOCKER_TAG == '' || params.BACKEND_DOCKER_TAG == '') {
                                  error("FRONTEND_DOCKER_TAG and BACKEND_DOCKER_TAG must be provided.")
                              }
                          }
                      }
                  }
                  stage("Workspace cleanup"){
                      steps{
                          script{
                              clean_workspace()
                          }
                      }
                  }
                  
                  stage('Git: Code Cloning') {
                      steps {
                          script{
                              clone("https://github.com/Sann-777/CI-CD-Mega-Project.git","main")
                          }
                      }
                  }
                  
                  stage("Trivy: Filesystem scan"){
                      steps{
                          script{
                              trivy_scan()
                          }
                      }
                  }
          
                  stage("OWASP: Dependency check"){
                      steps{
                          script{
                              owasp_dependency()
                          }
                      }
                  }
                  
                  stage("SonarQube: Code Analysis"){
                      steps{
                          script{
                              sonarqube_analysis("Sonar","wanderlust","wanderlust")
                          }
                      }
                  }
                  
                  stage("SonarQube: Code Quality Gates"){
                      steps{
                          script{
                              sonarqube_code_quality()
                          }
                      }
                  }
                  
                  stage('Exporting environment variables') {
                      parallel{
                          stage("Backend env setup"){
                              steps {
                                  script{
                                      dir("Automations"){
                                          sh "bash updatebackendnew.sh"
                                      }
                                  }
                              }
                          }
                          
                          stage("Frontend env setup"){
                              steps {
                                  script{
                                      dir("Automations"){
                                          sh "bash updatefrontendnew.sh"
                                      }
                                  }
                              }
                          }
                      }
                  }
                  
                  stage("Docker: Build Images"){
                      steps{
                          script{
                                  dir('backend'){
                                      docker_build("wanderlust-backend-beta","${params.BACKEND_DOCKER_TAG}","asxhazard")
                                  }
                              
                                  dir('frontend'){
                                      docker_build("wanderlust-frontend-beta","${params.FRONTEND_DOCKER_TAG}","asxhazard")
                                  }
                          }
                      }
                  }
                  
                  stage("Docker: Push to DockerHub"){
                      steps{
                          script{
                              docker_push("wanderlust-backend-beta","${params.BACKEND_DOCKER_TAG}","asxhazard") 
                              docker_push("wanderlust-frontend-beta","${params.FRONTEND_DOCKER_TAG}","asxhazard")
                          }
                      }
                  }
              }
              post{
                  success{
                      echo "CI of your project is successfull"
                      archiveArtifacts artifacts: '*.xml', followSymlinks: false
                      build job: "Project-CD", parameters: [
                          string(name: 'FRONTEND_DOCKER_TAG', value: "${params.FRONTEND_DOCKER_TAG}"),
                          string(name: 'BACKEND_DOCKER_TAG', value: "${params.BACKEND_DOCKER_TAG}")
                      ]
                  }
              }
          }
        </code>
        </pre>
        
      </section>
  
      <section id="cd-pipeline">
        <h2>üöÄ CD Pipeline with ArgoCD</h2>
        <p>For Continuous Deployment, I used ArgoCD on the <code>k3s</code> cluster.</p>
        <ul>
          <li>Created <code>argocd</code> namespace</li>
          <li>Installed ArgoCD using Helm</li>
          <li>Configured GitHub repo ‚Üí ArgoCD App ‚Üí Kubernetes cluster</li>
          <li>Enabled <strong>auto‚Äësync</strong>, <strong>prune</strong>, and <strong>self‚Äëheal</strong></li>
        </ul>
      </section>
      <pre style="max-height:400px; overflow:auto;">
      <code>
        @Library('Shared') _
        pipeline {
            agent {label 'vinod'}
            
            parameters {
              string(name: 'FRONTEND_DOCKER_TAG', defaultValue: '', description: 'Frontend Docker tag of the image built by the CI job')
              string(name: 'BACKEND_DOCKER_TAG', defaultValue: '', description: 'Backend Docker tag of the image built by the CI job')
            }

            stages {
                stage("Workspace cleanup"){
                    steps{
                        script{
                            clean_workspace()
                        }
                    }
                }
                
                stage('Git: Code Cloning') {
                    steps {
                        script{
                            clone("https://github.com/Sann-777/CI-CD-Mega-Project.git","main")
                        }
                    }
                }
               
                stage('Verify: Docker Image Tags') {
                  steps {
                      script{
                          echo "FRONTEND_DOCKER_TAG: ${params.FRONTEND_DOCKER_TAG}"
                          echo "BACKEND_DOCKER_TAG: ${params.BACKEND_DOCKER_TAG}"
                      }
                  }
                }

                stage("Update: Kubernetes manifests"){
                  steps{
                      script{
                          dir('kubernetes'){
                              sh """
                                  sed -i -e s/wanderlust-backend-beta.*/wanderlust-backend-beta:${params.BACKEND_DOCKER_TAG}/g backend.yaml
                              """
                          }
                          
                          dir('kubernetes'){
                              sh """
                                  sed -i -e s/wanderlust-frontend-beta.*/wanderlust-frontend-beta:${params.FRONTEND_DOCKER_TAG}/g frontend.yaml
                              """
                          }
                      }
                  }
                }
                
                stage("Git: Code update and push to GitHub"){
                  steps{
                      script{
                          withCredentials([gitUsernamePassword(credentialsId: 'Github-cred', gitToolName: 'Default')]) {
                              sh '''
                              echo "Checking repository status: "
                              git status
                          
                              echo "Adding changes to git: "
                              git add .
                              
                              echo "Setting Git identity: "
                              git config user.email "jenkins@example.com"
                              git config user.name "Jenkins CI"
      
                              echo "Committing changes: "
                              git commit -m "Updated environment variables" || echo "No changes to commit"
                              
                              echo "Pushing changes to github: "
                              git push https://github.com/Sann-777/CI-CD-Mega-Project.git main
                              '''
                          }
                      }
                  }
                }
              }
            }
      </code>
      </pre>
      
      <div class="screenshot">
        <p>Screenshot: ArgoCD App</p>
          <img src="images/ArgoCD.png" alt="ArgoCD App">
        </div>
      </section>
  
      <section id="monitoring">
        <h2>üìä Monitoring with Prometheus & Grafana</h2>
        <p>I deployed Prometheus and Grafana using Helm charts. They were scheduled on the worker node by applying <strong>node affinity</strong> (opposite of taints/tolerations).</p>
  
        <p>Grafana dashboards were configured to visualize cluster metrics, Jenkins jobs, and app performance.</p>
  
        <div class="screenshot">
          <p>Screenshot: Grafana Dashboard</p>
          <img src="images/Grafana.png" alt="Grafana Dashboard">
        </div>
      </section>
  
      <section id="conclusion">
        <h2>‚úÖ Conclusion</h2>
        <p>This project gave me hands‚Äëon experience in setting up an end‚Äëto‚Äëend CI/CD workflow, integrating DevSecOps practices, and implementing GitOps with ArgoCD. Even though it was a homelab setup, the concepts can scale to production environments with multiple nodes and cloud resources.</p>
      </section>
  
      <section class="tags">
        <h3>üè∑ Tags</h3>
        <span>DevOps</span>
        <span>CI/CD</span>
        <span>ArgoCD</span>
        <span>Jenkins</span>
        <span>Kubernetes</span>
        <span>Prometheus</span>
        <span>Grafana</span>
        <span>Homelab</span>
      </section>
    </div>
  </div>
</body>
</html>
